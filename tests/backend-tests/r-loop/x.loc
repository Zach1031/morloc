@path

null:main .
map  .
    & (null:loop . hclust $1 . dist . normalize . load_data . $1)
      (c . "iris" "cars" "mtcars")


@export
null:main as main

@arg
hclust :: method="average"


@lang
* :: R
mv :: sh


@cache
hclust :: datcache


@5
hclust :: plot_pdf . <hclust> $1


@include
core/datcache
core/atomic
core/control
core/R/common


@source R

# Load a builtin R dataset and return
load_data <- function(x) {
  eval(parse(text=x))
}

# Normalize numeric columns
normalize <- function(x) {
  as.data.frame(lapply(x, function(x) (x - mean(x)) / sd(x)))
}

columns_are_numeric <- function(x) {
  all(sapply(x, is.numeric)) 
}

plot_pdf <- function(x, name){
    path <- paste0("f-", name, ".pdf")
    pdf(path)
    plot(x)
    dev.off()
}
